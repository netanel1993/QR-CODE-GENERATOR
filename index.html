<!DOCTYPE html>
<html lang="he">
<head>
  google-site-verification: googled31f68093c7a279c.html
  <meta charset="UTF-8">
  <title>מחולל QR עם לוגו</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    body {
      direction: rtl;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom right, #fdfcfb, #e2d1c3);
      text-align: center;
      padding: 30px;
      color: #333;
      animation: fadeIn 1.5s ease-in-out;
    }
    h1 {
      color: #00796b;
      font-size: 2.2em;
      margin-bottom: 20px;
    }
    .form-group, #upload-logo {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin: 10px auto;
      width: 80%;
      max-width: 400px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input[type="text"] {
      width: 90%;
      padding: 10px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    input[type="color"] {
      margin: 0 5px;
    }
    button, a#pay-link {
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      background-color: #00796b;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 10px;
      border-radius: 6px;
      font-size: 1em;
      cursor: pointer;
      transition: background-color 0.3s;
      text-decoration: none;
      display: inline-block;
    }
    button:hover, a#pay-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      background-color: #004d40;
    }
    #qrcode {
      margin: 20px auto;
    }
    #upload-logo {
      display: none;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #qrcode canvas {
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      transition: transform 0.3s ease;
    }
    #qrcode canvas:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <p style="font-size: 1.2em; color: #555; max-width: 500px; margin: 0 auto 20px auto;">
    🌟 צור קוד QR מעוצב בהתאמה אישית – עכשיו עם אפשרות לשילוב לוגו עסקי לקידום מיתוג חכם. מתאים לעסקים, יוצרי תוכן, אירועים ועוד!
  </p>
  <h1>מחולל QR עם לוגו</h1>

  <div class="form-group">
    <input type="text" id="text" placeholder="הכנס טקסט או קישור ל־QR">
  </div>

  <div class="form-group">
    <label>צבע QR: <input type="color" id="qrColor" value="#000000"></label>
    <label>צבע רקע: <input type="color" id="bgColor" value="#ffffff"></label>
  </div>

  <button onclick="generateQR()">🎯 צור קוד QR</button>
  <div id="qrcode"></div>

  <a id="pay-link" href="https://www.paypal.com/donate/?hosted_button_id=6TS7T3778TGEA&return=success.html" target="_blank">💰 הוסף לוגו (₪9.90)</a>
  <br><br>
  <button onclick="downloadQR()">⬇️ הורד QR</button>
  <button onclick="shareOnWhatsApp()">📲 שתף ב־WhatsApp</button>

  <div id="upload-logo">
    <input type="file" id="logoInput" accept="image/*">
    <p>📎 העלאת לוגו תשלב אותו בתוך ה־QR</p>
  </div>

  <script>
    let qrCode;

    function generateQR() {
      const container = document.getElementById('qrcode');
      container.innerHTML = "";
      const text = document.getElementById('text').value;
      const color = document.getElementById('qrColor').value;
      const bgColor = document.getElementById('bgColor').value;
      if (text.trim() === "") return;

      localStorage.setItem('qr_text', text);
      localStorage.setItem('qr_color', color);
      localStorage.setItem('qr_bg', bgColor);

      qrCode = new QRCode(container, {
        width: 512,
        height: 512,
        colorDark: color,
        colorLight: bgColor,
        correctLevel: QRCode.CorrectLevel.H
      });
    }

    function downloadQR() {
      const container = document.getElementById('qrcode');
      const qrImg = container.querySelector('img') || container.querySelector('canvas');
      const logoInput = document.getElementById('logoInput');

      if (!qrImg) return alert("אנא צור קוד QR קודם");

      const canvas = document.createElement('canvas');
      canvas.width = 512;
      canvas.height = 512;
      const ctx = canvas.getContext('2d');

      const baseImage = new Image();
      baseImage.crossOrigin = "anonymous";
      baseImage.onload = function () {
        ctx.drawImage(baseImage, 0, 0, 512, 512);

        if (logoInput.files && logoInput.files[0]) {
          const reader = new FileReader();
          reader.onload = function (e) {
            const logo = new Image();
            logo.onload = function () {
              const logoSize = 60;
              const x = (canvas.width - logoSize) / 2;
              const y = (canvas.height - logoSize) / 2;
              ctx.drawImage(logo, x, y, logoSize, logoSize);
              saveFinal(canvas);
            };
            logo.src = e.target.result;
          };
          reader.readAsDataURL(logoInput.files[0]);
        } else {
          saveFinal(canvas);
        }
      };
      baseImage.src = qrImg.tagName === 'CANVAS' ? qrImg.toDataURL("image/png") : qrImg.src;
    }

    function saveFinal(canvas) {
      const image = canvas.toDataURL("image/png");
      const link = document.createElement('a');
      link.href = image;
      link.download = 'qrcode.png';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function enableLogoUpload() {
      const user = localStorage.getItem("user");
      const paid = localStorage.getItem("paid") === "true";
      if (!user && !paid) {
        alert("יש להתחבר או לשלם לפני העלאת לוגו");
        return;
      }
      document.getElementById("upload-logo").style.display = "block";
    }

    function shareOnWhatsApp() {
      const text = document.getElementById('text').value.trim();
      if (!text) return alert("לא ניתן לשתף קוד ריק");
      const url = encodeURIComponent(text);
      const whatsappLink = `https://wa.me/?text=${url}`;
      window.open(whatsappLink, '_blank');
    }

    if (localStorage.getItem("paid") === "true") {
      enableLogoUpload();
      const payLink = document.getElementById("pay-link");
      if (payLink) payLink.style.display = "none";
    }
  </script>
</body>
</html>
